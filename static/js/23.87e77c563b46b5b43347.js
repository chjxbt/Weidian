webpackJsonp([23],{"/GXu":function(t,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=i("woOf"),o=i.n(e),s=i("SKcX"),c=i("Y43X"),n=i("e81K"),r=i("P9l9"),l=i("mtWM"),d=i.n(l),h=i("Au9i"),m=i("CaOM"),u=i("iO08"),g={name:"activityContent",data:function(){return{baid:"",banner:"",activity_list:[],icon_list:[{src:"icon-like",name:"收藏",url:"icon-like"},{src:"icon-share",name:"转发",url:"icon-share"}],show_fixed:!1,tnid:"5ed4e908-a6db-11e8-b2ff-0cd292f93404",isScroll:!0,total_count:0,count:5,bottom_show:!1,code_src:"",components_src:"",shareParams:{media:[],product:{}},bigImg:"",show_big_img:!1}},components:{mFooter:s.a,ctx:c.a,share:n.a,attention:u.a},methods:{closeModal:function(t){this[t]=!1},touchMove:function(){var t=m.a.getScrollTop(),a=m.a.getScrollHeight();t+m.a.getClientHeight()>=a-10&&this.isScroll&&(this.isScroll=!1,this.activity_list.length==this.total_count?this.bottom_show=!0:this.loadBottom())},getActivity:function(t,a){var i=this;d.a.get(r.a.get_bigactivity+"?token="+localStorage.getItem("token"),{params:{page_num:t||1,page_size:a||this.count,baid:this.baid}}).then(function(a){if(200==a.data.status)if(i.isScroll=!0,i.total_count=a.data.data.total_count,i.banner=a.data.data.banner,1==a.data.data.batype){t?(i.activity_list=i.activity_list.concat(a.data.data.activity),i.activity_list.length==i.total_count&&(i.isScroll=!1)):i.activity_list=a.data.data.activity;for(var e=[].concat(i.activity_list),o=0;o<e.length;o++){var s=[{src:"icon-like",name:"123123",url:"icon-like"},{src:"icon-share",name:"转发",url:"icon-share"}];s[0].name=e[o].likenum,s[0].alreadylike=e[o].alreadylike,e[o].actext.length>92&&(e[o].show_text=!0),e[o].icon=[].concat(s)}i.activity_list=[].concat(e),i.show_big_img=!1}else i.show_big_img=!0,i.bigImg=a.data.data.banner;else Object(h.Toast)({message:a.data.message,className:"m-toast-fail"})})},loadTop:function(){this.getActivity(),this.$refs.loadmore.onTopLoaded()},loadBottom:function(){this.getActivity(this.activity_list.length,this.count)},iconClick:function(t,a){switch(t){case 0:this.changeLike(a);break;case 1:this.shareDone(a)}},shareDone:function(t){this.getEr(this.activity_list[t].acskiptype,t)},changeRoute:function(t,a,i){var e="";if(i){switch(t){case 0:return!1;case 1:e=this.title+"activityContent?openid="+localStorage.getItem("openid")+"&baid="+(i?this.activity_list[a].baid:a);break;case 3:e=this.title+"productDetail?openid="+localStorage.getItem("openid")+"&prid="+(i?this.activity_list[a].prid:a);break;case 2:e=this.title+"discover/index?openid="+localStorage.getItem("openid")+"&acid="+(i?this.activity_list[a].acid:a)+"&name=赚钱学院";break;case 4:e=this.title+"discover/index/index?openid="+localStorage.getItem("openid")+"&acid="+(i?this.activity_list[a].acid:a)+"&name=公告"}return e}switch(t){case 0:return!1;case 1:this.$router.push({path:"/activityContent",query:{openid:localStorage.getItem("openid"),baid:a}});break;case 2:this.$router.push({path:"/productDetail",query:{openid:localStorage.getItem("openid"),prid:a}});break;case 3:this.$router.push({path:"/discover",query:{openid:localStorage.getItem("openid"),acid:a,name:"赚钱学院"}});break;case 4:this.$router.push({path:"/discover",query:{openid:localStorage.getItem("openid"),acid:a,name:"公告"}})}},getEr:function(t,a){var i,e=this;i=this.changeRoute(t,a,"活动"),d.a.post(r.a.share_qrcode+"?token="+localStorage.getItem("token"),{dataurl:i}).then(function(t){200==t.data.status&&(e.code_src=t.data.qrcodeurl,e.components_src=t.data.components,e.shareParams.product=e.activity_list[a].product,e.shareParams.media=e.activity_list[a].media,e.show_fixed=!0)})},changeLike:function(t){var a=this.activity_list[t].icon[0];d.a.post(r.a.ac_like+"?token="+localStorage.getItem("token"),{acid:this.activity_list[t].acid}).then(function(t){200==t.data.status?a.alreadylike?(a.name-=1,a.alreadylike=!1,Object(h.Toast)({message:t.data.message,className:"m-toast-warning"})):a.alreadylike||(a.name=Number(a.name)+1,a.alreadylike=!0,Object(h.Toast)({message:t.data.message,className:"m-toast-success"})):Object(h.Toast)({message:t.data.message,className:"m-toast-fail"})})},showMoreText:function(t,a){var i=[].concat(this.activity_list);i[a]=o()({},i[a],{show_text:t}),this.activity_list=[].concat(i)}},mounted:function(){this.baid=this.$route.query.baid,this.getActivity()}},v={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{on:{touchmove:t.touchMove}},[t.show_big_img?i("div",{staticClass:"m-big-img"},[i("img",{staticClass:"activity-img ",attrs:{src:t.bigImg}})]):i("div",[i("img",{staticClass:"activity-img",attrs:{src:t.banner}}),t._v(" "),i("mt-loadmore",{ref:"loadmore",attrs:{"top-method":t.loadTop}},[i("div",{staticClass:"m-index-section"},[t._l(t.activity_list,function(a,e){return[i("ctx",{attrs:{icon:t.icon_list,list:a,index:e},on:{iconClick:t.iconClick,showMoreText:t.showMoreText}})]})],2)]),t._v(" "),t.show_fixed?i("attention",{on:{closeModal:function(a){t.closeModal("show_fixed")}}}):t._e(),t._v(" "),t.bottom_show?i("div",{staticClass:"bottom-prompt"},[i("div",{staticClass:"bottom-line"}),t._v(" "),i("div",{staticClass:"m-grey-color"},[t._v("我是有底线的")]),t._v(" "),i("div",{staticClass:"bottom-line"})]):t._e()],1)])},staticRenderFns:[]};var _=i("VU/8")(g,v,!1,function(t){i("kcAA")},"data-v-5cd49e1f",null);a.default=_.exports},kcAA:function(t,a){}});
//# sourceMappingURL=23.87e77c563b46b5b43347.js.map