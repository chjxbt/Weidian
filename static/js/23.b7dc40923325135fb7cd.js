webpackJsonp([23],{"/GXu":function(t,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=i("woOf"),o=i.n(e),s=i("SKcX"),c=i("Y43X"),n=i("e81K"),l=i("P9l9"),r=i("mtWM"),d=i.n(r),h=i("Au9i"),m=i("CaOM"),u=i("iO08"),v={name:"activityContent",data:function(){return{baid:"",banner:"",activity_list:[],icon_list:[{src:"icon-like",name:"收藏",url:"icon-like"},{src:"icon-share",name:"转发",url:"icon-share"}],show_fixed:!1,tnid:"5ed4e908-a6db-11e8-b2ff-0cd292f93404",isScroll:!0,total_count:0,count:5,bottom_show:!1}},components:{mFooter:s.a,ctx:c.a,share:n.a,attention:u.a},methods:{closeModal:function(t){this[t]=!1},touchMove:function(){var t=m.a.getScrollTop(),a=m.a.getScrollHeight();t+m.a.getClientHeight()>=a-10&&this.isScroll&&(this.isScroll=!1,this.activity_list.length==this.total_count?this.bottom_show=!0:this.loadBottom())},getActivity:function(t,a){var i=this;d.a.get(l.a.get_bigactivity+"?token="+localStorage.getItem("token"),{params:{page_num:t||1,page_size:a||this.count,baid:this.baid}}).then(function(a){if(200==a.data.status){i.isScroll=!0,i.total_count=a.data.data.total_count,i.banner=a.data.data.banner,t?(i.activity_list=i.activity_list.concat(a.data.data.activity),i.activity_list.length==i.total_count&&(i.isScroll=!1)):i.activity_list=a.data.data.activity;for(var e=[].concat(i.activity_list),o=0;o<e.length;o++){var s=[{src:"icon-like",name:"123123",url:"icon-like"},{src:"icon-share",name:"转发",url:"icon-share"}];s[0].name=e[o].likenum,s[0].alreadylike=e[o].alreadylike,e[o].actext.length>92&&(e[o].show_text=!0),e[o].icon=[].concat(s)}i.activity_list=[].concat(e)}else Object(h.Toast)({message:a.data.message,className:"m-toast-fail"})})},loadTop:function(){this.getActivity(),this.$refs.loadmore.onTopLoaded()},loadBottom:function(){this.getActivity(this.activity_list.length,this.count)},iconClick:function(t,a){switch(t){case 0:this.changeLike(a);break;case 1:this.show_fixed=!0}},changeLike:function(t){var a=this.activity_list[t].icon[0];d.a.post(l.a.ac_like+"?token="+localStorage.getItem("token"),{acid:this.activity_list[t].acid}).then(function(t){200==t.data.status?a.alreadylike?(a.name-=1,a.alreadylike=!1,Object(h.Toast)({message:t.data.message,className:"m-toast-warning"})):a.alreadylike||(a.name=Number(a.name)+1,a.alreadylike=!0,Object(h.Toast)({message:t.data.message,className:"m-toast-success"})):Object(h.Toast)({message:t.data.message,className:"m-toast-fail"})})},fixedClick:function(){this.show_fixed=!1},copyText:function(t){var a=window.location.href+this.activity_list[t].prid;this.$copyText(a).then(function(t){Object(h.Toast)({message:"复制成功",className:"m-toast-success"})})},showMoreText:function(t,a){var i=[].concat(this.activity_list);i[a]=o()({},i[a],{show_text:t}),this.activity_list=[].concat(i)}},mounted:function(){this.baid=this.$route.query.baid,this.getActivity()}},_={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{on:{touchmove:t.touchMove}},[i("img",{staticClass:"activity-img",attrs:{src:t.banner}}),t._v(" "),i("mt-loadmore",{ref:"loadmore",attrs:{"top-method":t.loadTop}},[i("div",{staticClass:"m-index-section"},[t._l(t.activity_list,function(a,e){return[i("ctx",{attrs:{icon:t.icon_list,list:a,index:e},on:{iconClick:t.iconClick,showMoreText:t.showMoreText}})]})],2)]),t._v(" "),t.show_fixed?i("attention",{on:{closeModal:function(a){t.closeModal("show_fixed")}}}):t._e(),t._v(" "),t.bottom_show?i("div",{staticClass:"bottom-prompt"},[i("div",{staticClass:"bottom-line"}),t._v(" "),i("div",{staticClass:"m-grey-color"},[t._v("我是有底线的")]),t._v(" "),i("div",{staticClass:"bottom-line"})]):t._e()],1)},staticRenderFns:[]};var f=i("VU/8")(v,_,!1,function(t){i("V76n")},"data-v-5eab60b0",null);a.default=f.exports},V76n:function(t,a){}});
//# sourceMappingURL=23.b7dc40923325135fb7cd.js.map