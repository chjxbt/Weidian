webpackJsonp([7],{"/M0C":function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=s("C3lA"),a=s("woOf"),c=s.n(a),o=s("P9l9"),n=s("mtWM"),l=s.n(n),m=s("Au9i"),r=s("Y43X"),v=s("e81K"),_=s("CaOM"),d=s("iO08"),u={data:function(){return{bannerList:[],recommend:{suuser:{}},activity_list:[],icon_list:[{src:"icon-like",name:"收藏",url:"icon-like"},{src:"icon-share",name:"转发",url:"icon-share"}],show_task:!1,show_fixed:!1,isScroll:!0,total_count:0,count:5,bottom_show:!1,shareParams:{}}},props:{tnid:{type:String,default:null}},components:{ctx:r.a,share:v.a,attention:d.a},methods:{touchMove:function(){var t=_.a.getScrollTop(),i=_.a.getScrollHeight();t+_.a.getClientHeight()>=i-10&&this.isScroll&&(this.isScroll=!1,this.activity_list.length==this.total_count||this.activity_list.length>this.total_count?this.bottom_show=!0:this.loadBottom())},getBanner:function(){var t=this;l.a.get(o.a.get_discover_banner+"?lasting=true&token="+localStorage.getItem("token")).then(function(i){200==i.data.status?t.bannerList=i.data.data:Object(m.Toast)({message:i.data.message,className:"m-toast-fail"})})},getData:function(){var t=this;l.a.get(o.a.get_info_recommend+"?token="+localStorage.getItem("token")).then(function(i){200==i.data.status?function(){t.recommend=i.data.data[0],t.suuser=t.recommend.suuser;for(var s=0;s<t.recommend.products.length;s++){var e=document.createElement("li");e.innerHTML="<img src="+t.recommend.products[s].prmainpic+" class='m-img-list-img'><p><span class='m-price'>￥"+t.recommend.products[s].prprice+"</span><span class='m-red'>赚"+t.recommend.products[s].prsavemonty+"</span></p>",document.getElementById("m-img-list").appendChild(e)}for(var a=t,c=document.getElementsByClassName("m-img-list-img"),o=0;o<c.length;o++)!function(t){c[t].onclick=function(){a.toProduct(t)}}(o)}():Object(m.Toast)({message:i.data.message,className:"m-toast-fail"})})},getActivity:function(t,i){var s=this;l.a.get(o.a.get_all_activity+"?token="+localStorage.getItem("token"),{params:{lasting:!0,start:t||0,count:i||this.count,tnid:this.tnid}}).then(function(i){if(200==i.data.status){s.isScroll=!0,s.total_count=i.data.count,s.activity_list=t?s.activity_list.concat(i.data.data):i.data.data;for(var e=[].concat(s.activity_list),a=0;a<e.length;a++){var c=[{src:"icon-like",name:"123123",url:"icon-like"},{src:"icon-share",name:"转发",url:"icon-share"}];c[0].name=e[a].likenum,c[0].alreadylike=e[a].alreadylike,e[a].actext.length>92&&(e[a].show_text=!0),e[a].icon=[].concat(c)}s.activity_list=[].concat(e)}else Object(m.Toast)({message:i.data.message,className:"m-toast-fail"})})},toActivity:function(t){var i=t.baid;this.$router.push({path:"/activityContent",query:{baid:i}})},toProduct:function(t){var i=this.recommend.products[t].prid;this.$router.push({path:"/productDetail",query:{prid:i}})},fixedClick:function(){this.show_fixed=!1},closeModal:function(t){this[t]=!1},iconClick:function(t,i){switch(t){case 0:this.changeLike(i);break;case 1:this.shareDone(i)}},shareDone:function(t){this.shareParams.product=this.activity_list[t].product,this.shareParams.media=this.activity_list[t].media,this.show_fixed=!0},likeThis:function(t){var i=this;t.alreadylike?l.a.post(o.a.re_like+"?token="+localStorage.getItem("token"),{reid:t.reid}).then(function(t){200==t.data.status?(i.recommend.relikenum-=1,i.recommend.alreadylike=!1,Object(m.Toast)({message:t.data.message,className:"m-toast-warning"})):Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})}):t.alreadylike||l.a.post(o.a.re_like+"?token="+localStorage.getItem("token"),{reid:t.reid}).then(function(t){200==t.data.status?(i.recommend.relikenum+=1,i.recommend.alreadylike=!0,Object(m.Toast)({message:t.data.message,className:"m-toast-success"})):Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})})},changeLike:function(t){var i=this.activity_list[t].icon[0];l.a.post(o.a.ac_like+"?token="+localStorage.getItem("token"),{acid:this.activity_list[t].acid}).then(function(t){200==t.data.status?i.alreadylike?(i.name-=1,i.alreadylike=!1,Object(m.Toast)({message:t.data.message,className:"m-toast-warning"})):i.alreadylike||(i.name=Number(i.name)+1,i.alreadylike=!0,Object(m.Toast)({message:t.data.message,className:"m-toast-success"})):Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})})},showMoreText:function(t,i){var s=[].concat(this.activity_list);s[i]=c()({},s[i],{show_text:t}),this.activity_list=[].concat(s)},copyText:function(t){var i=window.location.href+this.activity_list[t].prid;this.$copyText(i).then(function(t){Object(m.Toast)({message:"复制成功",className:"m-toast-success"})})},loadTop:function(){this.getActivity()},loadBottom:function(){this.getActivity(this.activity_list.length,this.count)}},mounted:function(){this.getBanner(),this.getData(),this.getActivity()}},h={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"m-discover-every",on:{touchmove:t.touchMove}},[s("div",{staticClass:"m-swipe-box"},[s("mt-swipe",{attrs:{auto:2e3}},t._l(t.bannerList,function(i){return s("mt-swipe-item",{key:i.id},[s("img",{staticClass:"img",attrs:{src:i.baimage},on:{click:function(s){t.toActivity(i)}}})])})),t._v(" "),t._m(0),t._v(" "),s("div",{staticClass:"m-title"},[s("div",[s("img",{staticClass:"m-item-title-img",attrs:{src:t.recommend.suuser.suheader}}),t._v(" "),s("span",[t._v(t._s(t.recommend.suuser.suname))])]),t._v(" "),s("div",{staticClass:"m-lookinfo-box"},[s("span",{staticClass:"m-look-icon"}),t._v(" "),s("span",[t._v(t._s(t.recommend.reviewnum))]),t._v(" "),s("span",{staticClass:"m-smile-icon",class:t.recommend.alreadylike?"active":"",on:{click:function(i){t.likeThis(t.recommend)}}}),t._v(" "),s("span",[t._v(t._s(t.recommend.relikenum))])])]),t._v(" "),s("div",{staticClass:"line"})],1),t._v(" "),s("div",{staticClass:"m-index-section"},[t._l(t.activity_list,function(i,e){return[s("ctx",{attrs:{icon:t.icon_list,list:i,index:e},on:{iconClick:t.iconClick,showMoreText:t.showMoreText}})]})],2),t._v(" "),t.bottom_show?s("div",{staticClass:"bottom-prompt"},[s("div",{staticClass:"bottom-line"}),t._v(" "),s("div",{staticClass:"m-grey-color"},[t._v("我是有底线的")]),t._v(" "),s("div",{staticClass:"bottom-line"})]):t._e(),t._v(" "),t.show_fixed?s("attention",{attrs:{show_fixed:t.show_fixed,shareParams:t.shareParams},on:{closeModal:function(i){t.closeModal("show_fixed")}}}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"m-scroll"},[i("ul",{staticClass:"m-img-list",attrs:{id:"m-img-list"}})])}]};var g=s("VU/8")(u,h,!1,function(t){s("ilry")},null,null).exports,f=s("ug6D"),y={data:function(){return{show_fixed:!1,icon_list:[{src:"icon-share",name:"转发",url:"icon-share"}],filtrateActivity:0,activity_list:[],count:20,shareParams:{}}},props:{tnid:{type:String,default:null},sub:{type:Array}},components:{iconList:f.a,share:v.a,attention:d.a},methods:{loadTop:function(){this.getActivity(0,this.count,this.sub[this.filtrateActivity].tnid)},iconClick:function(t,i){this.shareParams.product=this.activity_list[i].product,this.shareParams.media=this.activity_list[i].media,this.show_fixed=!0},fixedClick:function(){this.show_fixed=!1},closeModal:function(t){this[t]=!1},getActivity:function(t,i,s){var e=this;l.a.get(o.a.get_all_activity+"?token="+localStorage.getItem("token"),{params:{lasting:!0,start:t||0,count:i||this.count,tnid:s}}).then(function(t){if(200==t.data.status){e.activity_list=t.data.data;var i=new Date,s=i.getFullYear(),a=i.getMonth(),c=i.getDate(),o=i.getHours(),n=i.getMinutes(),l=i.getSeconds();(a+=1)<10&&(a="0"+a),c<10&&(c="0"+c),o<10&&(o="0"+o),n<10&&(n="0"+n),l<10&&(l="0"+l);for(var r=s+a+c+o+n+l,v=r.slice(0,4),_=r.slice(4,8),d=0;d<e.activity_list.length;d++){var u=e.activity_list[d].accreatetime,h=u.slice(0,4),g=u.slice(4,8);if(v==h)if(_.slice(0,2)==g.slice(0,2)){if(Number(_.slice(2,4))==Number(g.slice(2,4)))e.activity_list[d].accreatetime="今天 "+u.slice(8,10)+":"+u.slice(10,12);else if(Number(_.slice(2,4))==Number(g.slice(2,4))+1)e.activity_list[d].accreatetime="昨天 "+u.slice(8,10)+":"+u.slice(10,12);else if(Number(_.slice(2,4))>Number(g.slice(2,4))+1){var f=u.slice(4,6)+"-"+u.slice(6,8)+" "+u.slice(8,10)+":"+u.slice(10,12);e.activity_list[d].accreatetime=f}}else{var y=u.slice(4,6)+"-"+u.slice(6,8)+" "+u.slice(8,10)+":"+u.slice(10,12);e.activity_list[d].accreatetime=y}else{var p=u.slice(0,4)+"-"+u.slice(4,6)+"-"+u.slice(6,8)+" "+u.slice(8,10)+":"+u.slice(10,12);e.activity_list[d].accreatetime=p}e.activity_list[d].actext.length>90&&(e.activity_list[d].show_text=!0),0==e.activity_list[d].foward?e.activity_list[d].foward="":e.activity_list[d].foward=e.activity_list[d].foward+"人已发圈"}}else Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})})},changefiltrateActivity:function(t,i){this.filtrateActivity=i,this.getActivity(0,this.count,t.tnid)},showMore:function(t,i){var s=[].concat(this.activity_list);s[i]=c()({},s[i],{show_text:t}),this.activity_list=[].concat(s)}},mounted:function(){this.getActivity(0,this.count,this.sub[0].tnid)}},p={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"m-discover-fodder"},[t._l(t.sub,function(i,e){return s("span",{staticClass:"m-filtrate-box"},[s("span",{staticClass:"m-filtrate",class:e==t.filtrateActivity?"active":"",on:{click:function(s){t.changefiltrateActivity(i,e)}}},[t._v(t._s(i.tnname))])])}),t._v(" "),s("div",{staticClass:"m-discover-fodder-content"},t._l(t.activity_list,function(i,e){return s("div",{staticClass:"m-section-one"},[s("img",{staticClass:"m-section-img",attrs:{src:i.suuser.suheader}}),t._v(" "),s("div",{staticClass:"m-section-content"},[s("div",{staticClass:"m-section-title"},[s("span",{staticClass:"m-title"},[t._v(t._s(i.suuser.suname))])]),t._v(" "),s("p",{staticClass:"m-fodder-time"},[t._v(t._s(i.accreatetime)+" 发布")]),t._v(" "),s("div",{staticClass:"m-section-text"},[s("p",{staticClass:"textP",class:i.show_text?"":"active"},[t._v(t._s(i.actext))]),t._v(" "),i.show_text?s("span",{staticClass:"m-section-more",on:{click:function(i){t.showMore(!1,e)}}},[t._v("展开全文")]):t._e(),t._v(" "),i.actext.length>86&&!i.show_text?s("span",{staticClass:"m-section-more",on:{click:function(i){t.showMore(!0,e)}}},[t._v("收起全文")]):t._e(),t._v(" "),s("ul",{staticClass:"m-img-list",attrs:{id:"m-img-list"}},[s("li",[t._l(i.media,function(t){return[s("img",{staticClass:"m-section-text-img",attrs:{src:t.amimage}})]})],2)]),t._v(" "),s("div",{staticClass:"m-section-bottom"},[s("div",[s("div",[t._v(t._s(i.foward))])]),t._v(" "),s("div",[s("icon-list",{attrs:{list:t.icon_list,index:e},on:{iconClick:t.iconClick}})],1)])])])])})),t._v(" "),t.show_fixed?s("attention",{attrs:{shareParams:t.shareParams},on:{closeModal:function(i){t.closeModal("show_fixed")}}}):t._e()],2)},staticRenderFns:[]};var C=s("VU/8")(y,p,!1,function(t){s("th2D")},"data-v-abf98376",null).exports,w=s("7+uW"),k=s("flXH"),b=(s("fxnj"),{mixins:[k.a],data:function(){return{icon_list:[{src:"icon-share",name:"转发",url:"icon-share"},{src:"icon-message",name:"评论",url:"icon-message"}],show_fixed:!1,activity_list:[],comment:"",isScroll:!0,total_count:0,count:5,bottom_show:!1,shareParams:{}}},props:{tnid:{type:String,default:null}},components:{iconList:f.a,share:v.a,attention:d.a},methods:{bigImg:function(t){var i={current:t,urls:[t]};k.a.previewImage(i)},touchMove:function(){var t=_.a.getScrollTop(),i=_.a.getScrollHeight();t+_.a.getClientHeight()>=i-10&&this.isScroll&&(this.isScroll=!1,this.activity_list.length==this.total_count?this.bottom_show=!0:this.loadBottom())},loadTop:function(){this.getActivity()},loadBottom:function(){this.getActivity(this.activity_list.length,this.count)},getActivity:function(t,i){var s=this;l.a.get(o.a.get_all_activity+"?token="+localStorage.getItem("token"),{params:{start:t||0,count:i||this.count,tnid:this.tnid,acid:"公告"==this.$route.query.name&&this.$route.query.acid||""}}).then(function(i){if(200==i.data.status){s.isScroll=!0,s.total_count=i.data.count,t?(s.activity_list=s.activity_list.concat(i.data.data),s.activity_list.length==s.total_count&&(s.isScroll=!1)):s.activity_list=i.data.data;var e=[].concat(s.activity_list);s.activity_list=[].concat(e);var a=new Date,c=a.getFullYear(),o=a.getMonth(),n=a.getDate(),l=a.getHours(),r=a.getMinutes(),v=a.getSeconds();(o+=1)<10&&(o="0"+o),n<10&&(n="0"+n),l<10&&(l="0"+l),r<10&&(r="0"+r),v<10&&(v="0"+v);for(var _=c+o+n+l+r+v,d=_.slice(0,4),u=_.slice(4,8),h=0;h<s.activity_list.length;h++){var g=s.activity_list[h].accreatetime;if(-1==g.indexOf("-")){var f=g.slice(0,4),y=g.slice(4,8);if(d==f)if(u.slice(0,2)==y.slice(0,2)){if(Number(u.slice(2,4))==Number(y.slice(2,4)))s.activity_list[h].accreatetime="今天 "+g.slice(8,10)+":"+g.slice(10,12);else if(Number(u.slice(2,4))==Number(y.slice(2,4))+1)s.activity_list[h].accreatetime="昨天 "+g.slice(8,10)+":"+g.slice(10,12);else if(Number(u.slice(2,4))>Number(y.slice(2,4))+1){var p=g.slice(4,6)+"-"+g.slice(6,8)+" "+g.slice(8,10)+":"+g.slice(10,12);s.activity_list[h].accreatetime=p}}else{var C=g.slice(4,6)+"-"+g.slice(6,8)+" "+g.slice(8,10)+":"+g.slice(10,12);s.activity_list[h].accreatetime=C}else{var w=g.slice(0,4)+"-"+g.slice(4,6)+"-"+g.slice(6,8)+" "+g.slice(8,10)+":"+g.slice(10,12);s.activity_list[h].accreatetime=w}}s.activity_list[h].actext.length>90&&(s.activity_list[h].show_text=!0),0==s.activity_list[h].comment.length?s.activity_list[h].show_comment=!1:0!=s.activity_list[h].comment.length&&(s.activity_list[h].show_comment=!0),s.activity_list[h].show_input=!1}}else Object(m.Toast)({message:i.data.message,className:"m-toast-fail"})})},showMore:function(t,i){var s=[].concat(this.activity_list);s[i]=c()({},s[i],{show_text:t}),this.activity_list=[].concat(s)},getCommentList:function(){for(var t=0;t<this.activity_list.length;t++);l.a.post(o.a.ac_like,{acid:item.acid}).then(function(t){200==t.data.status?console.log(t.data.data):Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})})},iconClick:function(t,i){switch(t){case 0:this.shareDone(i);break;case 1:if(this.activity_list[i].show_comment)this.activity_list[i].show_input?this.activity_list[i].show_input=!1:this.activity_list[i].show_input||(this.activity_list[i].show_input=!0),0==this.activity_list[i].comment.length&&(this.activity_list[i].show_comment=!1,this.activity_list[i].show_input=!1);else if(!this.activity_list[i].show_comment){for(var s=0;s<this.activity_list.length;s++)this.activity_list[s].show_comment=!1;this.comment="",this.activity_list[i].show_comment=!0,this.activity_list[i].show_input=!0}w.default.set(this.activity_list,i,this.activity_list[i])}},shareDone:function(t){this.shareParams.product=this.activity_list[t].product,this.shareParams.media=this.activity_list[t].media,this.show_fixed=!0},fixedClick:function(){this.show_fixed=!1},closeModal:function(t){this[t]=!1},likeThis:function(t,i){var s=this;l.a.post(o.a.ac_like+"?token="+localStorage.getItem("token"),{acid:t.acid}).then(function(t){200==t.data.status?s.activity_list[i].alreadylike?(s.activity_list[i].likenum-=1,s.activity_list[i].alreadylike=!1,Object(m.Toast)({message:t.data.message,className:"m-toast-warning"})):s.activity_list[i].alreadylike||(s.activity_list[i].likenum+=1,s.activity_list[i].alreadylike=!0,Object(m.Toast)({message:t.data.message,className:"m-toast-success"})):Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})})},commentDone:function(t,i){var s=this;""==this.comment?Object(m.Toast)({message:"请填写评论内容",className:"m-toast-warning"}):""==!this.comment&&l.a.post(o.a.add_comment+"?token="+localStorage.getItem("token"),{acid:t.acid,ACtext:this.comment}).then(function(t){200==t.data.status?(s.activity_list[i].show_input=!1,s.activity_list[i].comment.splice(0,0,{user:{usname:"我"},actext:s.comment}),s.comment="",Object(m.Toast)({message:"评论成功",className:"m-toast-success"})):Object(m.Toast)({message:"评论失败",className:"m-toast-fail"})})}},mounted:function(){"公告"==this.$route.query.name&&(this.$store.state.tabbar_select="发现"),this.getActivity()}}),x={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"m-discover-announcement",on:{touchmove:t.touchMove}},[t._l(t.activity_list,function(i,e){return s("div",{staticClass:"m-section-one"},[s("div",{staticClass:"m-section-content"},[s("div",{staticClass:"m-section-title"},[s("img",{staticClass:"m-section-img",attrs:{src:i.suuser.suheader}}),t._v(" "),s("div",[s("span",{staticClass:"m-title"},[t._v(t._s(i.suuser.suname))]),t._v(" "),s("p",{staticClass:"m-fodder-time"},[t._v(t._s(i.accreatetime)+" 发布")])])]),t._v(" "),s("div",{staticClass:"m-section-text"},[s("p",{staticClass:"m-ft-30"},[i.acistop?s("span",{staticClass:"m-mark"},[t._v("置顶")]):t._e(),t._v(t._s(i.actitle))]),t._v(" "),s("p",{staticClass:"textP m-ft-28",class:i.show_text?"":"active"},[t._v(t._s(i.actext))]),t._v(" "),i.show_text?s("span",{staticClass:"m-section-more",on:{click:function(i){t.showMore(!1,e)}}},[t._v("展开全文")]):t._e(),t._v(" "),i.actext.length>86&&!i.show_text?s("span",{staticClass:"m-section-more",on:{click:function(i){t.showMore(!0,e)}}},[t._v("收起全文")]):t._e(),t._v(" "),s("div",{staticClass:"m-img-list"},[i.media.length>0?s("img",{staticClass:"m-section-text-img",attrs:{src:i.media[0].amimage},on:{click:function(s){t.bigImg(i.media[0].amimage)}}}):t._e()]),t._v(" "),s("div",{staticClass:"m-section-bottom"},[s("div",[s("div",{staticClass:"m-lookinfo-box"},[s("span",{staticClass:"m-look-icon"}),t._v(" "),s("span",[t._v(t._s(i.acbrowsenum))]),t._v(" "),s("span",{staticClass:"m-good-icon",class:i.alreadylike?"active":"",on:{click:function(s){t.likeThis(i,e)}}}),t._v(" "),s("span",[t._v(t._s(i.likenum)+"人说好")])])]),t._v(" "),s("div",[s("icon-list",{attrs:{list:t.icon_list,index:e},on:{iconClick:t.iconClick}})],1)]),t._v(" "),s("div",{staticClass:"m-comment-box"},[i.show_comment?s("div",{staticClass:"m-comment-content"},[s("span",{staticClass:"m-comment-s"}),t._v(" "),t._l(i.comment,function(i){return s("p",[s("span",{staticClass:"m-comment-name"},[t._v(t._s(i.user.usname))]),t._v(": "+t._s(i.actext)+"\n            ")])}),t._v(" "),i.show_input?s("div",{staticClass:"new-comment-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"new-comment-input",attrs:{type:"text"},domProps:{value:t.comment},on:{input:function(i){i.target.composing||(t.comment=i.target.value)}}}),t._v(" "),s("div",{staticClass:"new-comment-done",class:""!=t.comment?"active":"",on:{click:function(s){t.commentDone(i,e)}}},[t._v("发送")])]):t._e()],2):t._e()])])])])}),t._v(" "),t.bottom_show?s("div",{staticClass:"bottom-prompt"},[s("div",{staticClass:"bottom-line"}),t._v(" "),s("div",{staticClass:"m-grey-color"},[t._v("我是有底线的")]),t._v(" "),s("div",{staticClass:"bottom-line"})]):t._e(),t._v(" "),t.show_fixed?s("attention",{attrs:{shareParams:t.shareParams},on:{closeModal:function(i){t.closeModal("show_fixed")}}}):t._e()],2)},staticRenderFns:[]};var T=s("VU/8")(b,x,!1,function(t){s("rGpD")},"data-v-987cca9e",null).exports,N={mixins:[k.a],data:function(){return{icon_list:[{src:"icon-message",name:"评论",url:"icon-message"}],activity_list:[],show_fixed:!1,comment:"",isScroll:!0,total_count:0,count:5,bottom_show:!1}},props:{tnid:{type:String,default:null}},components:{iconList:f.a},methods:{iconClick:function(t,i){switch(t){case 0:if(this.activity_list[i].show_comment)this.activity_list[i].show_input?this.activity_list[i].show_input=!1:this.activity_list[i].show_input||(this.activity_list[i].show_input=!0),0==this.activity_list[i].comment.length&&(this.activity_list[i].show_comment=!1,this.activity_list[i].show_input=!1);else if(!this.activity_list[i].show_comment){for(var s=0;s<this.activity_list.length;s++)this.activity_list[s].show_comment=!1;this.comment="",this.activity_list[i].show_comment=!0,this.activity_list[i].show_input=!0}w.default.set(this.activity_list,i,this.activity_list[i])}},bigImg:function(t){var i={current:t,urls:[t]};k.a.previewImage(i)},playVideo:function(){document.getElementById("videoPlay").play()},closeModal:function(t){this[t]=!1},touchMove:function(){var t=_.a.getScrollTop(),i=_.a.getScrollHeight();t+_.a.getClientHeight()>=i-10&&this.isScroll&&(this.isScroll=!1,this.activity_list.length==this.total_count?this.bottom_show=!0:this.loadBottom())},loadTop:function(){this.getActivity()},loadBottom:function(){this.getActivity(this.activity_list.length,this.count)},getActivity:function(t,i){var s=this;l.a.get(o.a.get_all_activity+"?token="+localStorage.getItem("token"),{params:{start:t||0,count:i||this.count,tnid:this.tnid,acid:"赚钱学院"==this.$route.query.name&&this.$route.query.acid||""}}).then(function(i){if(200==i.data.status){s.isScroll=!0,s.total_count=i.data.count,t?(s.activity_list=s.activity_list.concat(i.data.data),s.activity_list.length==s.total_count&&(s.isScroll=!1)):s.activity_list=i.data.data;var e=[].concat(s.activity_list);s.activity_list=[].concat(e);var a=new Date,c=a.getFullYear(),o=a.getMonth(),n=a.getDate(),l=a.getHours(),r=a.getMinutes(),v=a.getSeconds();(o+=1)<10&&(o="0"+o),n<10&&(n="0"+n),l<10&&(l="0"+l),r<10&&(r="0"+r),v<10&&(v="0"+v);for(var _=c+o+n+l+r+v,d=_.slice(0,4),u=_.slice(4,8),h=0;h<s.activity_list.length;h++){var g=s.activity_list[h].accreatetime;if(-1==g.indexOf("-")){var f=g.slice(0,4),y=g.slice(4,8);if(d==f)if(u.slice(0,2)==y.slice(0,2)){if(Number(u.slice(2,4))==Number(y.slice(2,4)))s.activity_list[h].accreatetime="今天 "+g.slice(8,10)+":"+g.slice(10,12);else if(Number(u.slice(2,4))==Number(y.slice(2,4))+1)s.activity_list[h].accreatetime="昨天 "+g.slice(8,10)+":"+g.slice(10,12);else if(Number(u.slice(2,4))>Number(y.slice(2,4))+1){var p=g.slice(4,6)+"-"+g.slice(6,8)+" "+g.slice(8,10)+":"+g.slice(10,12);s.activity_list[h].accreatetime=p}}else{var C=g.slice(4,6)+"-"+g.slice(6,8)+" "+g.slice(8,10)+":"+g.slice(10,12);s.activity_list[h].accreatetime=C}else{var w=g.slice(0,4)+"-"+g.slice(4,6)+"-"+g.slice(6,8)+" "+g.slice(8,10)+":"+g.slice(10,12);s.activity_list[h].accreatetime=w}}s.activity_list[h].actext.length>90&&(s.activity_list[h].show_text=!0),0!=s.activity_list[h].media.length&&(s.activity_list[h].media[0].amvideo?s.activity_list[h].media[0].image=!1:s.activity_list[h].media[0].amimage&&(s.activity_list[h].media[0].image=!0)),0==s.activity_list[h].comment.length?s.activity_list[h].show_comment=!1:0!=s.activity_list[h].comment.length&&(s.activity_list[h].show_comment=!0),s.activity_list[h].show_input=!1}}else Object(m.Toast)({message:i.data.message,className:"m-toast-fail"})})},showMore:function(t,i){var s=[].concat(this.activity_list);s[i]=c()({},s[i],{show_text:t}),this.activity_list=[].concat(s)},getCommentList:function(){l.a.post(o.a.ac_like,{acid:item.acid}).then(function(t){200==t.data.status?console.log(t.data.data):Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})})},likeThis:function(t,i){var s=this;l.a.post(o.a.ac_like+"?token="+localStorage.getItem("token"),{acid:t.acid}).then(function(t){200==t.data.status?s.activity_list[i].alreadylike?(s.activity_list[i].likenum-=1,s.activity_list[i].alreadylike=!1,Object(m.Toast)({message:t.data.message,className:"m-toast-warning"})):s.activity_list[i].alreadylike||(s.activity_list[i].likenum+=1,s.activity_list[i].alreadylike=!0,Object(m.Toast)({message:t.data.message,className:"m-toast-success"})):Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})})},commentDone:function(t,i){var s=this;""==this.comment?Object(m.Toast)({message:"请填写评论内容",className:"m-toast-warning"}):""==!this.comment&&l.a.post(o.a.add_comment+"?token="+localStorage.getItem("token"),{acid:t.acid,ACtext:this.comment}).then(function(t){200==t.data.status?(s.activity_list[i].show_input=!1,s.activity_list[i].comment.splice(0,0,{user:{usname:"我"},actext:s.comment}),s.comment="",Object(m.Toast)({message:"评论成功",className:"m-toast-success"})):Object(m.Toast)({message:"评论失败",className:"m-toast-fail"})})}},mounted:function(){"赚钱学院"==this.$route.query.name&&(this.$store.state.tabbar_select="发现"),this.getActivity()}},S={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"m-discover-announcement",on:{touchmove:t.touchMove}},[t._l(t.activity_list,function(i,e){return s("div",{staticClass:"m-section-one"},[s("div",{staticClass:"m-section-content"},[s("div",{staticClass:"m-section-title"},[s("img",{staticClass:"m-section-img",attrs:{src:i.suuser.suheader}}),t._v(" "),s("div",[s("span",{staticClass:"m-title"},[t._v(t._s(i.suuser.suname))]),t._v(" "),s("p",{staticClass:"m-fodder-time"},[t._v(t._s(i.accreatetime)+" 发布")])])]),t._v(" "),s("div",{staticClass:"m-section-text"},[s("p",{staticClass:"m-ft-30"},[i.acistop?s("span",{staticClass:"m-mark"},[t._v("置顶")]):t._e(),t._v(t._s(i.actitle))]),t._v(" "),s("p",{staticClass:"textP m-ft-28",class:i.show_text?"":"active"},[t._v(t._s(i.actext))]),t._v(" "),i.show_text?s("span",{staticClass:"m-section-more",on:{click:function(i){t.showMore(!1,e)}}},[t._v("展开全文")]):t._e(),t._v(" "),i.actext.length>86&&!i.show_text?s("span",{staticClass:"m-section-more",on:{click:function(i){t.showMore(!0,e)}}},[t._v("收起全文")]):t._e(),t._v(" "),s("div",{staticClass:"m-img-list"},[i.media.length>0&&i.media[0].image?s("img",{staticClass:"section-text-img",attrs:{id:"downImg",src:i.media[0].amimage},on:{click:function(s){t.bigImg(i.media[0].amimage)}}}):t._e(),t._v(" "),i.media.length>0&&!i.media[0].image?s("div",{staticClass:"video-box",on:{click:function(i){t.playVideo()}}},[s("img",{staticClass:"video-img",attrs:{src:"/static/images/amvideothumbnail.jpg",alt:""}}),t._v(" "),s("video",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{src:i.media[0].amvideo,id:"videoPlay"}},[t._v("您的浏览器不支持 video 视频播放")])]):t._e()]),t._v(" "),s("div",{staticClass:"m-section-bottom"},[s("div",[s("div",{staticClass:"m-lookinfo-box"},[s("span",{staticClass:"m-look-icon"}),t._v(" "),s("span",[t._v(t._s(i.acbrowsenum))]),t._v(" "),s("span",{staticClass:"m-good-icon",class:i.alreadylike?"active":"",on:{click:function(s){t.likeThis(i,e)}}}),t._v(" "),s("span",[t._v(t._s(i.likenum)+"人说好")])])]),t._v(" "),s("div",[s("icon-list",{attrs:{list:t.icon_list,index:e},on:{iconClick:t.iconClick}})],1)]),t._v(" "),s("div",{staticClass:"m-comment-box"},[i.show_comment?s("div",{staticClass:"m-comment-content"},[s("span",{staticClass:"m-comment-s"}),t._v(" "),t._l(i.comment,function(i){return s("p",[s("span",{staticClass:"m-comment-name"},[t._v(t._s(i.user.usname))]),t._v(": "+t._s(i.actext)+"\n            ")])}),t._v(" "),i.show_input?s("div",{staticClass:"new-comment-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"new-comment-input",attrs:{type:"text"},domProps:{value:t.comment},on:{input:function(i){i.target.composing||(t.comment=i.target.value)}}}),t._v(" "),s("div",{staticClass:"new-comment-done",class:""!=t.comment?"active":"",on:{click:function(s){t.commentDone(i,e)}}},[t._v("发送")])]):t._e()],2):t._e()]),t._v(" "),t.show_fixed?s("div",{staticClass:"m-modal"},[s("div",{staticClass:"m-modal-state"},[s("div",{staticClass:"m-modal-head"},[s("span",{staticClass:"m-close",on:{click:function(i){t.show_fixed=!1}}},[t._v(" x ")])]),t._v(" "),s("div",{staticClass:"modal-text"},[t._v("素材已保存到相册")])])]):t._e()])])])}),t._v(" "),t.bottom_show?s("div",{staticClass:"bottom-prompt"},[s("div",{staticClass:"bottom-line"}),t._v(" "),s("div",{staticClass:"m-grey-color"},[t._v("我是有底线的")]),t._v(" "),s("div",{staticClass:"bottom-line"})]):t._e()],2)},staticRenderFns:[]};var M=s("VU/8")(N,S,!1,function(t){s("a6LR")},"data-v-742935d6",null).exports,O={data:function(){return{show_modal:!1,nav_list:[{tnid:"1"}],nav_select:"",sub:[]}},components:{navbar:e.a,fodder:C,every:g,announcement:T,course:M,iconList:f.a},mounted:function(){if(0==localStorage.getItem("user_level")&&(this.show_modal=!0),this.$route.query.name)switch(this.$route.query.name){case"赚钱学院":this.getTopnav(3);break;case"素材圈":this.getTopnav(1);break;case"公告":this.getTopnav(2)}else this.getTopnav()},methods:{loadTop:function(){0==this.nav_select?this.$refs.every.loadTop():1==this.nav_select?this.$refs.fodder.loadTop():2==this.nav_select?this.$refs.announcement.loadTop():3==this.nav_select&&this.$refs.course.loadTop(),this.$refs.loadmore.onTopLoaded()},navClick:function(t){for(var i=this.nav_list,s=0;s<i.length;s++)i[s].click=!1;i[t].click=!0,this.nav_list=[].concat(i),this.nav_select=t},getTopnav:function(t){var i=this,s=t||0;l.a.get(o.a.get_dp_topnav).then(function(t){200==t.data.status?(i.nav_list=t.data.data,i.sub=i.nav_list[1].sub,i.nav_list[s].click=!0,i.nav_select=s):Object(m.Toast)({message:t.data.message,className:"m-toast-fail"})})},toPage:function(t){"index"==t?(this.$store.state.tabbar_select="首页",this.$router.push("/index")):"partner"==t&&this.$router.push("/invitationLetter")}},created:function(){}},j={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"m-discover"},[s("mt-loadmore",{ref:"loadmore",attrs:{"top-method":t.loadTop}},[s("navbar",{attrs:{list:t.nav_list},on:{navClick:t.navClick}}),t._v(" "),"0"==t.nav_select?s("every",{ref:"every",attrs:{tnid:t.nav_list[0].tnid}}):t._e(),t._v(" "),"1"==t.nav_select?s("fodder",{ref:"fodder",attrs:{tnid:t.nav_list[1].tnid,sub:t.sub}}):t._e(),t._v(" "),"2"==t.nav_select?s("announcement",{ref:"announcement",attrs:{tnid:t.nav_list[2].tnid}}):t._e(),t._v(" "),"3"==t.nav_select?s("course",{ref:"course",attrs:{tnid:t.nav_list[3].tnid}}):t._e()],1),t._v(" "),t.show_modal?s("div",{staticClass:"m-modal"},[s("div",{staticClass:"m-modal-state"},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"m-modal-foot"},[s("span",{staticClass:"m-modal-foot-btn grey",on:{click:function(i){t.toPage("index")}}},[t._v("去首页逛逛")]),t._v(" "),s("span",{staticClass:"m-modal-foot-btn",on:{click:function(i){t.toPage("partner")}}},[t._v("我要成为店主")])])])]):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"m-modal-head m-modal-store"},[i("img",{staticClass:"m-modal-img",attrs:{src:"http://cdn2.55haitao.com/bbs/data/attachment/forum/201411/20/132745toqfxf1r19k3y333.jpg"}})])},function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"m-modal-content"},[s("h2",[t._v("升级成为店主·方可使用此功能")]),t._v(" "),s("ul",{staticClass:"m-modal-ul"},[s("li",[t._v("·"),s("span",[t._v("每日10荐 ")]),t._v("精品推荐")]),t._v(" "),s("li",[t._v("·"),s("span",[t._v("素  材  圈")]),t._v("时尚买家秀")]),t._v(" "),s("li",[t._v("·"),s("span",[t._v("公      告")]),t._v("活动奖励不多，更多玩法")]),t._v(" "),s("li",[t._v("·"),s("span",[t._v("教      程")]),t._v("精品专属教程")])])])}]};var A=s("VU/8")(O,j,!1,function(t){s("aOJI")},"data-v-333a12d8",null);i.default=A.exports},a6LR:function(t,i){},aOJI:function(t,i){},ilry:function(t,i){},rGpD:function(t,i){},th2D:function(t,i){}});
//# sourceMappingURL=7.dee308823475d2f78525.js.map