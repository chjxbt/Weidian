webpackJsonp([21],{"86SR":function(t,e){},u9if:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("P9l9"),a=s("mtWM"),n=s.n(a),r=s("Au9i"),l=s("CaOM"),o={data:function(){return{slider_index:1,slider_list:[{src:"",url:"",name:1},{src:"",url:"",name:2},{src:"",url:"",name:3},{src:"",url:"",name:4}],startX:0,endX:0,interval:"",person_info:null}},components:{},mounted:function(){this.getCode(),this.getInfo(),this.getRule(),l.a.changeTitle("邀请海报"),this.interval=window.setInterval(this.animation,3e3)},methods:{getCode:function(){var t,e=this;t=window.location.origin+"/#/index",n.a.post(i.a.share_qrcode+"?token="+localStorage.getItem("token"),{dataurl:t}).then(function(t){if(200==t.data.status){e.code_src=t.data.qrcodeurl;for(var s=0;s<e.slider_list.length;s++)e.drawWay(e.slider_list[s].name,e.slider_list[s].src)}})},getInfo:function(){var t=this;n.a.get(i.a.get_info_mycenter,{params:{token:localStorage.getItem("token")}}).then(function(e){200==e.data.status?t.person_info=e.data.data.user:Object(r.Toast)({message:e.data.message,className:"m-toast-fail"})},function(t){Object(r.Toast)({message:t.data.message,className:"m-toast-fail"})})},animation:function(t){t=t||1,this.slider_index==this.slider_list.length-1?this.slider_index=0:0==this.slider_index&&-1==t?this.slider_index=this.slider_list.length-1:this.slider_index=this.slider_index+t},touchStart:function(t){1==(t=t||event).touches.length&&(this.startX=t.touches[0].clientX);window.clearInterval(this.interval)},touchEnd:function(t){1==(t=t||event).changedTouches.length&&(this.endX=t.changedTouches[0].clientX),this.endX<this.startX?this.animation(1):this.animation(-1);this.interval=window.setInterval(this.animation,3e3)},drawWay:function(t,e){var s=document.createElement("canvas"),i=this,a=s.getContext("2d");s.height=870,s.width=580,a.rect(0,0,s.width,s.height),a.fillStyle="#efefef",a.fill();var n=new Image;n.crossOrigin="Anonymous",n.src=e,n.onload=function(){a.drawImage(n,0,0,580,870),a.fillStyle="#c3c3c3",a.beginPath(),i.drawRoundRect(a,110,55,140,52,25),a.fill(),a.fillStyle="#000",a.font="normal 26px PingFang-SC",a.fillText(i.person_info.usname,153,90),a.strokeStyle="#fff",a.beginPath(),a.lineWidth=10,a.arc(85,80,45,2*Math.PI,0,!0),a.closePath(),a.stroke();var e=new Image;e.crossOrigin="Anonymous",e.src=i.person_info.usheader,e.onload=function(){a.save(),a.arc(85,80,45,2*Math.PI,0,!0),a.clip(),a.drawImage(e,40,35,90,90),a.restore();var n=new Image;n.crossOrigin="Anonymous",n.src="/static/images/poster/fans_img.png",n.onload=function(){a.drawImage(n,90,580,200,200);var e=new Image;e.crossOrigin="Anonymous",e.src=i.code_src,e.onload=function(){console.log(i.code_src),a.drawImage(e,390,600,145,145);var n=s.toDataURL("image/png");document.getElementById(t).setAttribute("src",n)}}}}},drawRoundRect:function(t,e,s,i,a,n){t.beginPath(),t.arc(e+n,s+n,n,Math.PI,3*Math.PI/2),t.lineTo(i-n+e,s),t.arc(i-n+e,n+s,n,3*Math.PI/2,2*Math.PI),t.lineTo(i+e,a+s-n),t.arc(i-n+e,a-n+s,n,0,1*Math.PI/2),t.lineTo(n+e,a+s),t.arc(n+e,a-n+s,n,1*Math.PI/2,Math.PI),t.closePath()},changeImg:function(t){t==this.slider_index-1||0==this.slider_index&&t==this.slider_list.length-1?this.animation(1):(t==this.slider_index+1||this.slider_list.length-1==this.slider_index&&0==t)&&this.animation(-1)},getRule:function(){var t=this;n.a.get(i.a.get_image_by_aitype,{params:{token:localStorage.getItem("token"),aitype:10}}).then(function(e){if(200==e.data.status){for(var s=[],i=0;i<e.data.data.length;i++){var a={src:"",name:0};a.src=e.data.data[i].aiimage,a.name=i,s.push(a)}t.slider_list=[].concat(s)}else Object(r.Toast)({message:e.data.message,className:"m-toast-fail"})},function(t){Object(r.Toast)({message:t.data.message,className:"m-toast-fail"})})}},created:function(){}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-poster"},[s("span",{staticClass:"m-poster-close"},[t._v("X")]),t._v(" "),s("h3",[t._v("选择海报")]),t._v(" "),s("div",{staticClass:"m-slider-box"},[s("ul",{staticStyle:{"margin-left":"0px"},attrs:{id:"m-slider-ul"},on:{touchstart:t.touchStart,touchend:t.touchEnd}},[t._l(t.slider_list,function(e,i){return[s("li",{class:i==t.slider_index-1||0==t.slider_index&&i==t.slider_list.length-1?"m-slider-left m-slider-side":i==t.slider_index?"m-slider-in":i==t.slider_index+1||t.slider_list.length-1==t.slider_index&&0==i?"m-slider-right m-slider-side":""},[s("img",{staticClass:"m-slider-img",attrs:{src:"",id:e.name,alt:""}})])]})],2),t._v(" "),s("span",{staticClass:"m-slider-index"},[t._v(t._s(t.slider_index+1)+"/"+t._s(t.slider_list.length))])]),t._v(" "),t._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"m-poster-btn"},[e("span",{staticClass:"m-poster-btn-icon"}),this._v(" "),e("p",[this._v("长按保存，转发朋友圈")])])}]};var c=s("VU/8")(o,d,!1,function(t){s("86SR")},"data-v-675f5534",null);e.default=c.exports}});
//# sourceMappingURL=21.5c9d8d64588cdb24314a.js.map