{"version":3,"sources":["webpack:///src/views/discover/activityContent.vue","webpack:///./src/views/discover/activityContent.vue?766b","webpack:///./src/views/discover/activityContent.vue"],"names":["activityContent","name","data","baid","activity_list","icon_list","src","url","show_fixed","tnid","isScroll","total_count","count","components","mFooter","footer","ctx","share","attention","methods","closeModal","v","this","touchMove","scrollTop","common","getScrollTop","scrollHeight","getScrollHeight","getClientHeight","loadBottom","length","Object","mint_ui_common","message","className","getActivity","start","_this","axios_default","a","get","api","get_all_activity","localStorage","getItem","params","then","res","status","concat","arr","i","_arr","likenum","alreadylike","actext","show_text","icon","loadTop","$refs","loadmore","onTopLoaded","onBottomLoaded","iconClick","list","changeLike","index","post","ac_like","acid","Number","fixedClick","copyText","link","window","location","href","prid","$copyText","e","showMoreText","bool","assign_default","mounted","$route","query","discover_activityContent","render","_vm","_h","$createElement","_c","_self","on","touchmove","staticClass","attrs","_v","ref","top-method","_l","item","$event","_e","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/31.3a99cf9c1b991e657547.js","sourcesContent":["<template>\r\n  <div @touchmove=\"touchMove\">\r\n    <img class=\"activity-img\" src=\"\">\r\n\r\n    <mt-loadmore :top-method=\"loadTop\" ref=\"loadmore\">\r\n      <div class=\"m-index-section\">\r\n        <template v-for=\"(item,index) in activity_list\">\r\n          <ctx :icon=\"icon_list\" :list=\"item\" :index=\"index\" @iconClick=\"iconClick\" @showMoreText=\"showMoreText\"></ctx>\r\n        </template>\r\n      </div>\r\n    </mt-loadmore>\r\n\r\n    <!--<share v-if=\"show_fixed\" @fixedClick=\"fixedClick\"></share>-->\r\n    <attention v-if=\"show_fixed\" @closeModal=\"closeModal('show_fixed')\"></attention>\r\n\r\n    <!--<m-footer></m-footer>-->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import mFooter from '../../components/common/footer';\r\n  import ctx from '../index/components/ctx';\r\n  import share from '../../components/common/share';\r\n  import api from '../../api/api';\r\n  import axios from 'axios';\r\n  import { Toast } from 'mint-ui';\r\n  import common from '../../common/js/common';\r\n  import attention from '../../components/common/attention';\r\n\r\n  export default {\r\n    name: \"activityContent\",\r\n    data() {\r\n      return {\r\n        baid: \"\",\r\n        activity_list: [],\r\n        icon_list:[\r\n          {\r\n            src:'icon-like',\r\n            name:'收藏',\r\n            url:'icon-like'\r\n          },\r\n          /*{\r\n            src:'icon-lian',\r\n            name:'复制链接',\r\n            url:'icon-lian'\r\n          },*/\r\n          {\r\n            src:'icon-share',\r\n            name:'转发',\r\n            url:'icon-share'\r\n          }\r\n        ],\r\n        show_fixed: false,\r\n        tnid: \"5ed4e908-a6db-11e8-b2ff-0cd292f93404\", // ertiao\r\n        isScroll: true,\r\n        total_count: 0,\r\n        count: 5\r\n      }\r\n    },\r\n    components: { mFooter, ctx, share, attention },\r\n    methods: {\r\n      /*关闭分享的模态框*/\r\n      closeModal(v){\r\n        // console.log(v);\r\n        this[v]  = false;\r\n      },\r\n      touchMove(){\r\n        let scrollTop = common.getScrollTop();\r\n        let scrollHeight = common.getScrollHeight();\r\n        let ClientHeight = common.getClientHeight()\r\n        if (scrollTop + ClientHeight >= scrollHeight -10) {\r\n          if(this.isScroll){\r\n            this.isScroll = false;\r\n            this.loadBottom();\r\n          }else  if(this.activity_list.length == this.total_count){\r\n            this.isScroll = false;\r\n            Toast({ message: '数据已加载完', className: 'm-toast-warning' });\r\n          }\r\n        }\r\n      },\r\n      /*获取活动列表*/\r\n      getActivity(start, count){\r\n        axios.get(api.get_all_activity + '?token=' + localStorage.getItem('token'), {\r\n          params: { start: start || 0, count: count || this.count, tnid: this.tnid }}).then(res => {\r\n          if(res.data.status == 200){\r\n            this.isScroll = true;\r\n            this.total_count = res.data.count;\r\n\r\n            if(start){\r\n              this.activity_list = this.activity_list.concat(res.data.data);\r\n              if(this.activity_list.length == this.total_count){\r\n                this.isScroll = false;\r\n              }\r\n            }else{\r\n              this.activity_list = res.data.data;\r\n            }\r\n\r\n            let arr = [].concat(this.activity_list);\r\n            for(let i=0;i<arr.length;i++) {\r\n              let _arr = [\r\n                {\r\n                  src: 'icon-like',\r\n                  name: '123123',\r\n                  url: 'icon-like'\r\n                },\r\n                /*{\r\n                  src: 'icon-lian',\r\n                  name: '复制链接',\r\n                  url: 'icon-lian'\r\n                },*/\r\n                {\r\n                  src: 'icon-share',\r\n                  name: '转发',\r\n                  url: 'icon-share'\r\n                }\r\n              ];\r\n              _arr[0].name = arr[i].likenum;\r\n              _arr[0].alreadylike = arr[i].alreadylike;\r\n              arr[i].actext.length > 92 && (arr[i].show_text = true);\r\n              arr[i].icon = [].concat(_arr);\r\n              // console.log(_arr[0].name, arr[i].likenum)\r\n            }\r\n            this.activity_list = [].concat(arr);\r\n          }else{\r\n            Toast({ message: res.data.message, className: 'm-toast-fail' });\r\n          }\r\n        })\r\n      },\r\n      // 下拉刷新\r\n      loadTop() {\r\n        this.getActivity();\r\n        this.$refs.loadmore.onTopLoaded();\r\n      },\r\n      // 上拉加载更多\r\n      loadBottom() {\r\n        this.getActivity(this.activity_list.length, this.count);\r\n        this.$refs.loadmore.onBottomLoaded();\r\n      },\r\n      /*每个活动icon点击*/\r\n      iconClick(v, list){\r\n        switch (v){\r\n          case 0:\r\n            this.changeLike(list);\r\n            break;\r\n          /*case 1:\r\n            this.copyText(list);\r\n            break;*/\r\n          case 1:\r\n            this.show_fixed = true;\r\n            break;\r\n        }\r\n      },\r\n      // 活动点赞\r\n      changeLike(index) {\r\n        let arr = this.activity_list[index].icon[0];\r\n        // console.log(arr);\r\n        axios.post(api.ac_like + '?token=' + localStorage.getItem('token'), {\r\n          acid: this.activity_list[index].acid\r\n        }).then(res => {\r\n          if(res.data.status == 200){\r\n            if(arr.alreadylike) {\r\n              arr.name -= 1;\r\n              arr.alreadylike = false;\r\n              Toast({ message: res.data.message, className: 'm-toast-warning' });\r\n            }else if(!arr.alreadylike) {\r\n              arr.name = Number(arr.name) + 1;\r\n              arr.alreadylike = true;\r\n              Toast({ message: res.data.message, className: 'm-toast-success' });\r\n            }\r\n            // console.log(arr);\r\n          }else{\r\n            Toast({ message: res.data.message, className: 'm-toast-fail' });\r\n          }\r\n        });\r\n      },\r\n      /*分享按钮点击*/\r\n      fixedClick(){\r\n        this.show_fixed = false;\r\n      },\r\n      // 复制链接\r\n      copyText(list) {\r\n        let link = window.location.href + this.activity_list[list].prid;\r\n        this.$copyText(link).then(function (e) {\r\n          Toast({ message: \"复制成功\", className: 'm-toast-success' });\r\n        })\r\n      },\r\n      // 展开全文、收齐全文\r\n      showMoreText(bool,v){\r\n        let arr = [].concat(this.activity_list);\r\n        arr[v] = Object.assign({}, arr[v], { show_text: bool });\r\n        this.activity_list = [].concat(arr);\r\n      },\r\n    },\r\n    mounted() {\r\n      this.baid = this.$route.query.baid;\r\n\r\n      this.getActivity();\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" rel=\"stylesheet/less\" scoped>\r\n  @import \"../../common/css/index\";\r\n\r\n  .activity-img {\r\n    width: 750px;\r\n    height: 280px;\r\n    margin-bottom: 40px;\r\n  }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/discover/activityContent.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{on:{\"touchmove\":_vm.touchMove}},[_c('img',{staticClass:\"activity-img\",attrs:{\"src\":\"\"}}),_vm._v(\" \"),_c('mt-loadmore',{ref:\"loadmore\",attrs:{\"top-method\":_vm.loadTop}},[_c('div',{staticClass:\"m-index-section\"},[_vm._l((_vm.activity_list),function(item,index){return [_c('ctx',{attrs:{\"icon\":_vm.icon_list,\"list\":item,\"index\":index},on:{\"iconClick\":_vm.iconClick,\"showMoreText\":_vm.showMoreText}})]})],2)]),_vm._v(\" \"),(_vm.show_fixed)?_c('attention',{on:{\"closeModal\":function($event){_vm.closeModal('show_fixed')}}}):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-41617a9e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/discover/activityContent.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-41617a9e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":true}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./activityContent.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./activityContent.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./activityContent.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-41617a9e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./activityContent.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-41617a9e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/discover/activityContent.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}