{"version":3,"sources":["webpack:///src/views/discover/activityContent.vue","webpack:///./src/views/discover/activityContent.vue?91ec","webpack:///./src/views/discover/activityContent.vue"],"names":["activityContent","name","data","rbimage","activity_list","icon_list","src","url","show_fixed","tnid","isScroll","total_count","count","components","mFooter","footer","ctx","share","attention","methods","closeModal","v","this","touchMove","scrollTop","common","getScrollTop","scrollHeight","getScrollHeight","getClientHeight","loadBottom","length","Object","mint_ui_common","message","className","getActivity","start","_this","axios_default","a","get","api","get_all_activity","localStorage","getItem","params","then","res","status","concat","arr","i","_arr","likenum","alreadylike","actext","show_text","icon","loadTop","$refs","loadmore","onTopLoaded","onBottomLoaded","iconClick","list","changeLike","index","post","ac_like","acid","Number","fixedClick","copyText","link","window","location","href","prid","$copyText","e","showMoreText","bool","assign_default","mounted","$route","query","discover_activityContent","render","_vm","_h","$createElement","_c","_self","on","touchmove","staticClass","attrs","_v","ref","top-method","_l","item","$event","_e","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/22.5fc2075a7deec4e686b1.js","sourcesContent":["<template>\n  <div @touchmove=\"touchMove\">\n    <img class=\"activity-img\" :src=\"rbimage\">\n\n    <mt-loadmore :top-method=\"loadTop\" ref=\"loadmore\">\n      <div class=\"m-index-section\">\n        <template v-for=\"(item,index) in activity_list\">\n          <ctx :icon=\"icon_list\" :list=\"item\" :index=\"index\" @iconClick=\"iconClick\" @showMoreText=\"showMoreText\"></ctx>\n        </template>\n      </div>\n    </mt-loadmore>\n\n    <!--<share v-if=\"show_fixed\" @fixedClick=\"fixedClick\"></share>-->\n    <attention v-if=\"show_fixed\" @closeModal=\"closeModal('show_fixed')\"></attention>\n\n    <!--<m-footer></m-footer>-->\n  </div>\n</template>\n\n<script>\n  import mFooter from '../../components/common/footer';\n  import ctx from '../index/components/ctx';\n  import share from '../../components/common/share';\n  import api from '../../api/api';\n  import axios from 'axios';\n  import { Toast } from 'mint-ui';\n  import common from '../../common/js/common';\n  import attention from '../../components/common/attention';\n\n  export default {\n    name: \"activityContent\",\n    data() {\n      return {\n        rbimage: \"\",\n        activity_list: [],\n        icon_list:[\n          {\n            src:'icon-like',\n            name:'收藏',\n            url:'icon-like'\n          },\n          /*{\n            src:'icon-lian',\n            name:'复制链接',\n            url:'icon-lian'\n          },*/\n          {\n            src:'icon-share',\n            name:'转发',\n            url:'icon-share'\n          }\n        ],\n        show_fixed: false,\n        tnid: \"5ed4e908-a6db-11e8-b2ff-0cd292f93404\", // ertiao\n        isScroll: true,\n        total_count: 0,\n        count: 5\n      }\n    },\n    components: { mFooter, ctx, share, attention },\n    methods: {\n      /*关闭分享的模态框*/\n      closeModal(v){\n        // console.log(v);\n        this[v]  = false;\n      },\n      touchMove(){\n        let scrollTop = common.getScrollTop();\n        let scrollHeight = common.getScrollHeight();\n        let ClientHeight = common.getClientHeight()\n        if (scrollTop + ClientHeight >= scrollHeight) {\n          if(this.isScroll){\n            this.isScroll = false;\n            this.loadBottom();\n          }else  if(this.activity_list.length == this.total_count){\n            this.isScroll = false;\n            Toast({ message: '数据已加载完', className: 'm-toast-warning' });\n          }\n        }\n      },\n      /*获取活动列表*/\n      getActivity(start, count){\n        axios.get(api.get_all_activity + '?token=' + localStorage.getItem('token'), {\n          params: { start: start || 0, count: count || this.count, tnid: this.tnid }}).then(res => {\n          if(res.data.status == 200){\n            this.isScroll = true;\n            this.total_count = res.data.count;\n\n            if(start){\n              this.activity_list = this.activity_list.concat(res.data.data);\n              if(this.activity_list.length == this.total_count){\n                this.isScroll = false;\n              }\n            }else{\n              this.activity_list = res.data.data;\n            }\n\n            let arr = [].concat(this.activity_list);\n            for(let i=0;i<arr.length;i++) {\n              let _arr = [\n                {\n                  src: 'icon-like',\n                  name: '123123',\n                  url: 'icon-like'\n                },\n                /*{\n                  src: 'icon-lian',\n                  name: '复制链接',\n                  url: 'icon-lian'\n                },*/\n                {\n                  src: 'icon-share',\n                  name: '转发',\n                  url: 'icon-share'\n                }\n              ];\n              _arr[0].name = arr[i].likenum;\n              _arr[0].alreadylike = arr[i].alreadylike;\n              arr[i].actext.length > 92 && (arr[i].show_text = true);\n              arr[i].icon = [].concat(_arr);\n              // console.log(_arr[0].name, arr[i].likenum)\n            }\n            this.activity_list = [].concat(arr);\n          }else{\n            Toast({ message: res.data.message, className: 'm-toast-fail' });\n          }\n        })\n      },\n      // 下拉刷新\n      loadTop() {\n        this.getActivity();\n        this.$refs.loadmore.onTopLoaded();\n      },\n      // 上拉加载更多\n      loadBottom() {\n        this.getActivity(this.activity_list.length, this.count);\n        this.$refs.loadmore.onBottomLoaded();\n      },\n      /*每个活动icon点击*/\n      iconClick(v, list){\n        switch (v){\n          case 0:\n            this.changeLike(list);\n            break;\n          /*case 1:\n            this.copyText(list);\n            break;*/\n          case 1:\n            this.show_fixed = true;\n            break;\n        }\n      },\n      // 活动点赞\n      changeLike(index) {\n        let arr = this.activity_list[index].icon[0];\n        // console.log(arr);\n        axios.post(api.ac_like + '?token=' + localStorage.getItem('token'), {\n          acid: this.activity_list[index].acid\n        }).then(res => {\n          if(res.data.status == 200){\n            if(arr.alreadylike) {\n              arr.name -= 1;\n              arr.alreadylike = false;\n              Toast({ message: res.data.message, className: 'm-toast-warning' });\n            }else if(!arr.alreadylike) {\n              arr.name = Number(arr.name) + 1;\n              arr.alreadylike = true;\n              Toast({ message: res.data.message, className: 'm-toast-success' });\n            }\n            // console.log(arr);\n          }else{\n            Toast({ message: res.data.message, className: 'm-toast-fail' });\n          }\n        });\n      },\n      /*分享按钮点击*/\n      fixedClick(){\n        this.show_fixed = false;\n      },\n      // 复制链接\n      copyText(list) {\n        let link = window.location.href + this.activity_list[list].prid;\n        this.$copyText(link).then(function (e) {\n          Toast({ message: \"复制成功\", className: 'm-toast-success' });\n        })\n      },\n      // 展开全文、收齐全文\n      showMoreText(bool,v){\n        let arr = [].concat(this.activity_list);\n        arr[v] = Object.assign({}, arr[v], { show_text: bool });\n        this.activity_list = [].concat(arr);\n      },\n    },\n    mounted() {\n      this.rbimage = this.$route.query.rbimage;\n\n      this.getActivity();\n    }\n  }\n</script>\n\n<style lang=\"less\" rel=\"stylesheet/less\">\n  @import \"../../common/css/index\";\n\n  .activity-img {\n    width: 750px;\n    height: 280px;\n    margin-bottom: 40px;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/discover/activityContent.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{on:{\"touchmove\":_vm.touchMove}},[_c('img',{staticClass:\"activity-img\",attrs:{\"src\":_vm.rbimage}}),_vm._v(\" \"),_c('mt-loadmore',{ref:\"loadmore\",attrs:{\"top-method\":_vm.loadTop}},[_c('div',{staticClass:\"m-index-section\"},[_vm._l((_vm.activity_list),function(item,index){return [_c('ctx',{attrs:{\"icon\":_vm.icon_list,\"list\":item,\"index\":index},on:{\"iconClick\":_vm.iconClick,\"showMoreText\":_vm.showMoreText}})]})],2)]),_vm._v(\" \"),(_vm.show_fixed)?_c('attention',{on:{\"closeModal\":function($event){_vm.closeModal('show_fixed')}}}):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-89f98384\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/discover/activityContent.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-89f98384\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":true}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./activityContent.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./activityContent.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./activityContent.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-89f98384\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./activityContent.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/discover/activityContent.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}