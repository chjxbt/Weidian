webpackJsonp([23],{"/GXu":function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=a("woOf"),o=a.n(e),s=a("SKcX"),c=a("Y43X"),n=a("e81K"),l=a("P9l9"),r=a("mtWM"),h=a.n(r),d=a("Au9i"),m=a("CaOM"),u=a("iO08"),f={name:"activityContent",data:function(){return{rbimage:"",activity_list:[],icon_list:[{src:"icon-like",name:"收藏",url:"icon-like"},{src:"icon-share",name:"转发",url:"icon-share"}],show_fixed:!1,tnid:"5ed4e908-a6db-11e8-b2ff-0cd292f93404",isScroll:!0,total_count:0,count:5}},components:{mFooter:s.a,ctx:c.a,share:n.a,attention:u.a},methods:{closeModal:function(t){this[t]=!1},touchMove:function(){var t=m.a.getScrollTop(),i=m.a.getScrollHeight();t+m.a.getClientHeight()>=i&&(this.isScroll?(this.isScroll=!1,this.loadBottom()):this.activity_list.length==this.total_count&&(this.isScroll=!1,Object(d.Toast)({message:"数据已加载完",className:"m-toast-warning"})))},getActivity:function(t,i){var a=this;h.a.get(l.a.get_all_activity+"?token="+localStorage.getItem("token"),{params:{start:t||0,count:i||this.count,tnid:this.tnid}}).then(function(i){if(200==i.data.status){a.isScroll=!0,a.total_count=i.data.count,t?(a.activity_list=a.activity_list.concat(i.data.data),a.activity_list.length==a.total_count&&(a.isScroll=!1)):a.activity_list=i.data.data;for(var e=[].concat(a.activity_list),o=0;o<e.length;o++){var s=[{src:"icon-like",name:"123123",url:"icon-like"},{src:"icon-share",name:"转发",url:"icon-share"}];s[0].name=e[o].likenum,s[0].alreadylike=e[o].alreadylike,e[o].actext.length>92&&(e[o].show_text=!0),e[o].icon=[].concat(s)}a.activity_list=[].concat(e)}else Object(d.Toast)({message:i.data.message,className:"m-toast-fail"})})},loadTop:function(){this.getActivity(),this.$refs.loadmore.onTopLoaded()},loadBottom:function(){this.getActivity(this.activity_list.length,this.count),this.$refs.loadmore.onBottomLoaded()},iconClick:function(t,i){switch(t){case 0:this.changeLike(i);break;case 1:this.show_fixed=!0}},changeLike:function(t){var i=this.activity_list[t].icon[0];h.a.post(l.a.ac_like+"?token="+localStorage.getItem("token"),{acid:this.activity_list[t].acid}).then(function(t){200==t.data.status?i.alreadylike?(i.name-=1,i.alreadylike=!1,Object(d.Toast)({message:t.data.message,className:"m-toast-warning"})):i.alreadylike||(i.name=Number(i.name)+1,i.alreadylike=!0,Object(d.Toast)({message:t.data.message,className:"m-toast-success"})):Object(d.Toast)({message:t.data.message,className:"m-toast-fail"})})},fixedClick:function(){this.show_fixed=!1},copyText:function(t){var i=window.location.href+this.activity_list[t].prid;this.$copyText(i).then(function(t){Object(d.Toast)({message:"复制成功",className:"m-toast-success"})})},showMoreText:function(t,i){var a=[].concat(this.activity_list);a[i]=o()({},a[i],{show_text:t}),this.activity_list=[].concat(a)}},mounted:function(){this.rbimage=this.$route.query.rbimage,this.getActivity()}},g={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{on:{touchmove:t.touchMove}},[a("img",{staticClass:"activity-img",attrs:{src:t.rbimage}}),t._v(" "),a("mt-loadmore",{ref:"loadmore",attrs:{"top-method":t.loadTop}},[a("div",{staticClass:"m-index-section"},[t._l(t.activity_list,function(i,e){return[a("ctx",{attrs:{icon:t.icon_list,list:i,index:e},on:{iconClick:t.iconClick,showMoreText:t.showMoreText}})]})],2)]),t._v(" "),t.show_fixed?a("attention",{on:{closeModal:function(i){t.closeModal("show_fixed")}}}):t._e()],1)},staticRenderFns:[]};var v=a("VU/8")(f,g,!1,function(t){a("UIw9")},null,null);i.default=v.exports},UIw9:function(t,i){}});
//# sourceMappingURL=23.46eff42664cb1cf74afe.js.map